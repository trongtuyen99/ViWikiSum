keyword: Ma trận hiệp phương sai
url: https://minhng.info/toan-hoc/ma-tran-hiep-phuong-sai-covariance-matrix.html
content:
Bài viết này mình không nói sâu về lý thuyết mà tập trung giải thích về các bước tính toán ma trận hiệp phương sai, cũng như giải thích ý nghĩa của ma trận này để bạn cảm thấy dễ nhớ hơn là việc học thuộc công thức. Cách hiểu này cũng sẽ hỗ trợ bạn trong việc ứng dụng, khi nào áp dụng việc tính toán covariance matrix trong quá trình làm nghiên cứu. Ma trận hiệp phương sai của tập hợp m biến ngẫu nhiên là một ma trận vuông hạng (m × m), trong đó các phần tử nằm trên đường chéo (từ trái sang phải, từ trên xuống dưới) lần lượt là phương sai tương ứng của các biến này (ta chú ý rằng Var(X) = Cov(X,X)), trong khi các phần tử còn lại (không nằm trên đường chéo) là các hiệp phương sai của đôi một hai biến ngẫu nhiên khác nhau trong tập hợp. Định nghĩa ma trận hiệp phương sai có vẻ khó hiểu, nhưng khi ta xem xét một bài toán cụ thể thì sẽ dễ hiểu hơn. Ta xem xét ví dụ sau và cách tính toán ma trận hiệp phương sai. Như vậy ta có N mẫu dữ liệu (N=3), và mỗi mẫu dữ liệu là một điểm trên không gian 2 chiều (m=2). Nếu trực quan hóa thì 3 điểm dữ liệu A, B, C sẽ nằm như sau trên trục tọa độ:. Với 3 mẫu dữ liệu trên, ta tìm cách sắp chúng lại thành ma trận có kích thước m x N (2 dòng, 3 cột). Để làm điều đó dễ dàng, ta sắp chúng thành ma trận có kích thước N x m trước, sau đó chuyển vị để được ma trận m x N. Ma trận K có kích thước m x N (2x3) với m là số chiều của mẫu dữ liệu, N là số mẫu dữ liệu. Do mỗi điểm của chúng ta nằm trên không gian 2 chiều (m=2), do đó khi ta tìm trọng tâm M (giá trị trung bình của N mẫu trên không gian m chiều, tạm gọi nó là mẫu trung bình) thì trọng tâm này cũng là 2 chiều. Nói cách khác, để tính M, ta tính trung bình trên từng dòng của ma trận K. Kết quả biểu diễn dưới dạng ma trận:. Ma trận A có kích thước m x N, ma trận B có kích thước N x m => ma trận kết quả C = A * B có kích thước m x m. (c) và (c) lần lượt là phương sai (variance) của trục X và trục Y. Nói cách khác, các phần tử trên đường chéo chính của ma trận hiệp phương sai là các phương sai của các mẫu dữ liệu. Ma trận hiệp phương sai có tính chất đối xứng qua đường chéo chính. Lý do: bạn sẽ để ý rằng (c) và (c) được tính bởi tích vô hướng của 2 vector (r1*r2) và (r2*r1) đều cho ra kết quả tính toán như nhau. Đây là nhận xét chủ quan của Minh đúc kết về ý nghĩa của ma trận hiệp phương sai dựa trên quá trình tính toán trong ví dụ phía trên. Các phần tử trên đường chéo chính của ma trận hiệp phương sai lần lượt là các phương sai của các mẫu dữ liệu theo từng chiều trong không gian m chiều. Kết quả mà Minh đã tính toán trong ví dụ trên có sự sai lệch nhỏ là do làm tròn ở các bước tính trung gian.
